---
title: "Compare Correlations Summary Example"
description: >
  This page compares a correlation between two variables in two independent samples using summary statistics input.
output: rmarkdown::html_vignette
---

```{r, include=FALSE}
knitr::opts_chunk$set(fig.width = 7, fig.height = 6, comment = NA)
```

```{r, include=FALSE}
if (!require(EASI)) {
  if (!require(remotes)) install.packages("remotes")
  remotes::install_github("cwendorf/EASI")
}
library(EASI)
```

This page compares a correlation between two variables in two independent samples using summary statistics input.

## Data Management

### Data Entry

This code inputs the variable summaries and creates a summary table.
```{r}
Outcome1 <- c(N = 10, M = 8.000, SD = 1.414)
Outcome2 <- c(N = 10, M = 11.000, SD = 2.211)
Outcome3 <- c(N = 10, M = 12.000, SD = 2.449)
MixedSummaryL1 <- construct(Outcome1, Outcome2, class = "wss")
```

This code creates a correlation matrix.
```{r}
Outcome1 <- c(1.000, .533, .385)
Outcome2 <- c(.533, 1.000, .574)
Outcome3 <- c(.385, .574, 1.000)
MixedCorrL1 <- construct(Outcome1, Outcome2, Outcome3, class = "corr")
```

And repeat the process to create the second subset.
```{r}
Outcome1 <- c(N = 10, M = 8.000, SD = 2.449)
Outcome2 <- c(N = 10, M = 8.000, SD = 2.000)
Outcome3 <- c(N = 10, M = 7.000, SD = 2.211)
MixedSummaryL2 <- construct(Outcome1, Outcome2, Outcome3, class = "wss")
```

And for the correlation matrix of the second subset.
```{r}
Outcome1 <- c(1.000, .408, .164)
Outcome2 <- c(.408, 1.000, .553)
Outcome3 <- c(.164, .553, 1.000)
MixedCorrL2 <- construct(Outcome1, Outcome2, Outcome3, class = "corr")
```

### Summary Statistics

This code confirms the descriptive statistics from the summary tables.
```{r}
(MixedSummaryL1) |> describeSummary()
(MixedCorrL1) |> describeCorrelations()
(MixedSummaryL2) |> describeSummary()
(MixedCorrL2) |> describeCorrelations()
```

## Analyses of a Correlation Comparison

The main question is whether the correlation between Body Satisfaction and Wellbeing is different in the two groups.

First it is necessary to estimate the confidence intervals for each of the correlations.
```{r}
CorrEstimateL1 <- (MixedSummaryL1) |> focus(Outcome1, Outcome2) |> estimateCorrelations(MixedCorrL1)
CorrEstimateL2 <- (MixedSummaryL2) |> focus(Outcome1, Outcome2) |> estimateCorrelations(MixedCorrL2)
```

Then we can estimate the correlations and the difference in the correlations.
```{r, Compare-Summary-Difference}
estimateCorrelationsDifference(CorrEstimateL1, CorrEstimateL2)
plotCorrelationsDifference(CorrEstimateL1, CorrEstimateL2)
```

If desired, the estimates of the correlations and the difference can be combined in one analyses.
```{r, Compare-Summary-Comparison}
estimateCorrelationsComparison(CorrEstimateL1, CorrEstimateL2)
plotCorrelationsComparison(CorrEstimateL1, CorrEstimateL2)
```
