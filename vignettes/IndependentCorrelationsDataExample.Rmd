---
title: "Independent Correlations Data Example"
description: >
  This page compares a correlation between two variables in two independent samples using raw data input.
output: rmarkdown::html_vignette
---

```{r, include=FALSE}
knitr::opts_chunk$set(fig.width = 7, fig.height = 6, comment = NA)
```

```{r, include=FALSE}
if (!require(EASI)) {
  if (!require(remotes)) install.packages("remotes")
  remotes::install_github("cwendorf/EASI")
}
library(EASI)
```

This page compares a correlation between two variables in two independent samples using raw data input.

## Data Management

### Data Entry

This code inputs the variable names and creates a viewable data frame.
```{r}
Factor <- c(rep(1, 10), rep(2, 10))
Factor <- factor(Factor, levels = c(1, 2), labels = c("Level1", "Level2"))
Outcome1 <- c(6, 8, 6, 8, 10, 8, 10, 9, 8, 7, 5, 9, 10, 9, 11, 4, 11, 7, 6, 8)
Outcome2 <- c(7, 13, 11, 10, 13, 8, 11, 14, 12, 11, 7, 8, 7, 11, 10, 7, 8, 4, 8, 10)
Outcome3 <- c(9, 16, 11, 12, 15, 13, 9, 14, 11, 10, 8, 6, 8, 11, 5, 7, 9, 3, 6, 7)
MixedData <- construct(Factor, Outcome1, Outcome2, Outcome3)
```

This code subsets the data into two different data frames (one for each group).
```{r}
MixedDataL1 <- (MixedData) |> focus(Factor == "Level1")
MixedDataL2 <- (MixedData) |> focus(Factor == "Level2")
```

### Summary Statistics

This code obtains the descriptive statistics for the two data frames.
```{r}
(MixedData) |> focus(Outcome1, Outcome2, Outcome3) |> describeSummaryBy(by = Factor)
(MixedData) |> focus(Outcome1, Outcome2, Outcome3) |> describeCorrelationsBy(by = Factor)
```

## Analyses of a Correlation Comparison

This section produces analyses that whether the correlation between two variables is different in the two groups.

First, it is necessary to estimate the confidence intervals for each of the correlations.
```{r}
CorrEstimateL1 <- (MixedDataL1) |> focus(Outcome1, Outcome2) |> estimateCorrelations()
CorrEstimateL2 <- (MixedDataL2) |> focus(Outcome1, Outcome2) |> estimateCorrelations()
```

Then we can estimate and plot the correlations and the difference in the correlations.
```{r, Compare-Data-Difference}
estimateCorrelationsDifference(CorrEstimateL1, CorrEstimateL2)
plotCorrelationsDifference(CorrEstimateL1, CorrEstimateL2)
```

If desired, the estimates of the correlations and the difference can be combined in one analyses.
```{r, Compare-Data-Comparison}
estimateCorrelationsComparison(CorrEstimateL1, CorrEstimateL2)
plotCorrelationsComparison(CorrEstimateL1, CorrEstimateL2)
```
