---
title: "Estimation Approach to Statistical Inference"
author: "Craig A. Wendorf"
date: "2020-06-20"
output: 
  rmarkdown::html_vignette:
    keep_md: TRUE
vignette: >
  %\VignetteIndexEntry{Repeated Measures (Within-Subjects) Example with Donohue Summary Statistics}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
devtools::source_gist("c83e078bf8c81b035e32c3fc0cf04ee8",filename="render_toc.R")
```

```{r,include=FALSE}
#suppress the warnings and other messages from showing in the knitted file.
knitr::opts_chunk$set(fig.width=7, fig.height=5,fig.path='figures/',echo=TRUE,warning=FALSE,message=FALSE)
```

```{r,include=FALSE}
library(EASI)
```

## Repeated Measures (Within-Subjects) Example with Donohue Summary Statistics

### Table of Contents

```{r toc, echo=FALSE}
sourceDir <- getSrcDirectory(function(dummy) {dummy})
setwd(sourceDir)
render_toc("DonohueSummaryExample.Rmd")
```

### Data Management

Prior to analyses, enter the tables of summary statistics.

```{r}
Pretest <- c(N=20,M=19.300,SD=5.904)
Posttest <- c(N=20,M=23.600,SD=4.762)
Followup <- c(N=20,M=23.400,SD=4.616)
DonohueSummary <- rbind(Pretest,Posttest,Followup)
class(DonohueSummary) <- "wss"

DonohueCorr <- declareCorrelations("Pretest","Posttest","Followup")
DonohueCorr["Pretest","Posttest"] <- .493
DonohueCorr["Pretest","Followup"] <- .536
DonohueCorr["Posttest","Followup"] <- .743
DonohueCorr <- fillCorrelations(DonohueCorr)
```

### Analyses of the Different Variables

With multiple variables, it is useful to get descriptive statistics and confidence intervals for each variable.

```{r}
estimateMeans(DonohueSummary,main="Critical Thinking Scores Before and After Course")
```

It is also useful to view the means and confidence intervals of the groups in a plot.

```{r,Donohue-Means}
plotMeans(DonohueSummary,main="Critical Thinking Scores Before and After Course",ylab="Critical Thinking")
```
 
### Analysis of a Variable Difference

The first research question is whether there is a difference between the posttest and followup occasions.

First, set the comparison and get an estimate of the difference and its confidence interval.

```{r}
PostvsFollowup <- DonohueSummary[c(2,3),]
class(PostvsFollowup) <- "wss"
estimateDifference(PostvsFollowup,DonohueCorr,main="Critical Thinking After the Course")
```

Then, obtain the difference plot for that comparison.

```{r,Donohue-Difference}
plotDifference(PostvsFollowup,DonohueCorr,main="Critical Thinking After the Course",ylab="Critical Thinking")
```

Finally, obtain the standardized effect size for that comparison.

```{r}
standardizeDifference(PostvsFollowup,DonohueCorr,main="Cohens d for Critical Thinking After the Course")
```

### Analysis of a Variable Contrast

The second research question is whether the pretest differs from the posttest and followup combined.

First, set the contrast and get an estimate of the contrast and its confidence interval.

```{r}
PrevsPostFollow <- c(-1,.5,.5)
estimateContrast(DonohueSummary,DonohueCorr,contrast=PrevsPostFollow,main="Critical Thinking Before vs After the Course")
```

Then, obtain a difference plot for the contrast.

```{r,Donohue-Contrast}
plotContrast(DonohueSummary,DonohueCorr,contrast=PrevsPostFollow,labels=c("Pretest","Post&Follow"),main="Critical Thinking Before vs After the Course",ylab="Critical Thinking")
```

Finally, estimate the standardized contrast.

```{r}
standardizeContrast(DonohueSummary,DonohueCorr,contrast=PrevsPostFollow,main="Cohens d for Critical Thinking Before vs After the Course")
```
