---
subtitle: "Pairwise Repeated Measures Data Application"
output:
  github_document:
    preserve_yaml: FALSE
vignette: >
  %\VignetteIndexEntry{Pairwise Repeated Measures Data Application}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include=FALSE}
knitr::opts_chunk$set(fig.width = 7, fig.height = 6, fig.path = "figures/", echo = TRUE, warning = FALSE, message = FALSE)
devtools::source_gist("8e6e5dc401e3fc1042ef7a030f9d19c7", filename = "revised_toc.R")
```

```{r, include=FALSE}
if (!require(EASI)) {
  if (!require(remotes)) install.packages("remotes")
  remotes::install_github("cwendorf/EASI")
}
library(EASI)
```

## Pairwise Repeated Data Application

This page examines unadjusted pairwise comparisons and Tukey post hoc comparisons with traditional confidence interval plots, relational interval plots, and diffograms using repeated-measures (within-subjects) data.

```{r toc, echo=FALSE}
thisfile <- knitr::current_input()
revised_toc(thisfile, base_level = 3, toc_depth = 4)
```

---

### Data Management

This code inputs the variable names and creates a viewable data frame.
```{r}
Outcome1 <- c(6, 8, 6, 8, 10, 8, 10, 9, 8, 7)
Outcome2 <- c(7, 13, 11, 10, 13, 8, 11, 14, 12, 11)
Outcome3 <- c(9, 16, 11, 12, 15, 13, 9, 14, 11, 10)
RepeatedData <- construct(Outcome1, Outcome2, Outcome3)
```

### Omnibus Analyses

Provide an ANOVA source table.
```{r}
(RepeatedData) |> describeMeansEffect()
(RepeatedData) |> testMeansEffect()
```

### Analyses of Pairwise Comparisons

The analyses for the pairwise comparisons do not assume homogeneity of variance and do not make adjustments for multiple comparisons (and are therefore effectively equivalent to a series of paired samples t tests).

Obtain tables of the interval estimates for the pairwise comparisons, tests of their statistical significance, and their standardized effect sizes.
```{r}
(RepeatedData) |> estimateMeansPairwise()
(RepeatedData) |> testMeansPairwise()
(RepeatedData) |> estimateStandardizedMeansPairwise()
```

Provide a traditional plot of the confidence intervals for the pairwise comparisons (including a line that represents no difference for the comparisons).
```{r, Pairwise-Repeated-Pairwise}
(RepeatedData) |> plotMeansPairwise(line = 0, values = FALSE)
```

Provide a diffogram (plot of means and the confidence intervals for the pairwise comparisons)and specify colors for intervals that do not include zero (darkblue) and those that do include zero (darkred).
```{r, Pairwise-Repeated-DiffogramA}
(RepeatedData) |> plotMeansPairwiseDiffogram(col = c("darkblue", "darkred"))
```

### Analyses of Relational Intervals

The analyses for the relational confidence intervals do assume homogeneity of variance but do not make adjustments for multiple comparisons.

Provide estimates of the arelational and relational intervals.
```{r, Pairwise-Repeated-RelationalA}
(RepeatedData) |> estimateMeansRelational()
```

Plot the intervals and enhance with color.
```{r, Pairwise-Repeated-RelationalB}
(RepeatedData) |> plotMeansRelational(col = c("darkred", "darkblue", "darkgoldenrod"))
```

### Analyses of Post Hoc Comparisons

The analyses for the post hoc comparisons do assume homogeneity of variance and do make adjustments for multiple comparisons (based on Tukey HSD procedures).

Obtain tables of the interval estimates for the posthoc comparisons, tests of their statistical significance, and their standardized effect sizes.
```{r}
(RepeatedData) |> estimateMeansPosthoc()
(RepeatedData) |> testMeansPairwise()
(RepeatedData) |> estimateStandardizedMeansPosthoc()
```

Provide a traditional plot of the confidence intervals for the post hoc comparisons (including a line that represents no difference for the comparisons).
```{r, Pairwise-Repeated-Posthoc}
(RepeatedData) |> plotMeansPosthoc(line = 0, values = FALSE)
```

Provide a diffogram (plot of means and the confidence intervals for the post hoc comparisons) and specify colors for intervals that do not include zero (darkblue) and those that do include zero (darkred).
```{r, Pairwise-Repeated-DiffogramB}
(RepeatedData) |> plotMeansPosthocDiffogram(col = c("darkblue", "darkred"))
```
